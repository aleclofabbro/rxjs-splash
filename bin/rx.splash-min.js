(function(){var e,n,t,r={}.hasOwnProperty,i=function(e,n){for(var t in n){if(r.call(n,t))e[t]=n[t]}function i(){this.constructor=e}i.prototype=n.prototype;e.prototype=new i;e.__super__=n.prototype;return e};t=window.sx={utils:{},internal:{},binders:{}};n=function(){};e={dispose:n};t.utils.bind=function(e,n){if(e.subscribe){return e.subscribe(n)}return n(e)};t.utils.parseBindingOptions=function(e,n){var t,r;if(n==null){n={}}if(typeof e==="function"||e.onNext||e.subscribe){n.source=e;return n}for(t in e){r=e[t];n[t]=r}return n};t.utils.toJS=function(e){return JSON.stringify(e,function(e,n){if(n instanceof t.ObservableArray){return n.values}if(n instanceof Rx.Observable){return n.value}if(n instanceof Rx.Observer){return void 0}return n})};t.utils.unwrap=function(e){if(e.value&&e.subscribe){return e.value}return e};t.utils.wrap=function(e){if(e.value&&e.subscribe){return e}return new Rx.BehaviorSubject(e)};t.bind=function(e,n){n=$(n||window.document.body);return t.internal.bind(n,{vm:e,vmRoot:e,vmParent:void 0})};t.computed=function(e){var n,r,i,o,s,u;r=[];s=[];u=e.params;for(n in u){o=u[n];r.push(n);s.push(t.utils.wrap(o))}i=t.utils.combineLatest(s).select(function(e){var t,i,o,s;i={};for(t=o=0,s=r.length;o<s;t=++o){n=r[t];i[n]=e[t]}return i});return Rx.Observable.create(function(n){return i.select(e.read).subscribe(n)})};t.internal.bind=function(e,n){var r,i,o,s;i=t.internal.parseBindings(e,n);o=new Rx.CompositeDisposable;for(r in i){s=i[r];o.add(t.binders[r](e,n,s))}e.children().each(function(){return o.add(t.internal.bind($(this),n))});return o};t.internal.parseBindings=function(e,n){var t,r,i,o,s,u;t=e.attr("data-splash");if(!t){return null}i=["$data","$root","$parent"];s=[n.vm,n.vmRoot,n.vmParent];u=n.vm;for(r in u){o=u[r];i.push(r);s.push(o)}return new Function(i,"return { "+t+" };").apply(null,s)};t.ObservableArray=function(e){i(n,e);function n(e){var t,r,i;if(e==null){e=[]}n.__super__.constructor.apply(this,arguments);this.values=[];this.lifetimes=[];for(r=0,i=e.length;r<i;r++){t=e[r];this.push(t)}}n.prototype.push=function(e){var n;this.values.push(e);this.lifetimes.push(n=new Rx.BehaviorSubject(e));this.onNext(n);return e};n.prototype.remove=function(e){var n;n=this.values.indexOf(e);if(n===-1){console.log(n)}return this.splice(n,1)};n.prototype.splice=function(){var e,n,t,r,i;Array.prototype.splice.apply(this.values,arguments);n=Array.prototype.splice.apply(this.lifetimes,arguments);i=[];for(t=0,r=n.length;t<r;t++){e=n[t];i.push(e.onCompleted())}return i};n.prototype.subscribe=function(e){var t,r,i,o,s;r=n.__super__.subscribe.apply(this,arguments);this.purge();e=arguments.length>1||typeof e==="function"?e:e.onNext;s=this.lifetimes;for(i=0,o=s.length;i<o;i++){t=s[i];e(t)}return r};n.prototype.purge=function(){var e,n,t,r,i;r=this.lifetimes;i=[];for(n=0,t=r.length;n<t;n++){e=r[n];if(e.isCompleted){i.push(this.remove(e))}}return i};n.prototype.dispose=function(){var e,n,t,r,i;r=this.lifetimes;i=[];for(n=0,t=r.length;n<t;n++){e=r[n];i.push(e.onCompleted())}return i};return n}(Rx.Subject);t.binders.attr=function(e,n,r){var i,o,s,u,a;o=new Rx.CompositeDisposable;for(s=u=0,a=r.length;u<a;s=++u){i=r[s];o.add(t.utils.bind(s,function(n){e.attr(i,n)}))}return o};t.binders.checked=function(e,n,r){var i,o,s;if(r.onNext){o=r;i=e.onAsObservable("change").select(function(){return e.prop("checked")}).subscribe(function(e){o.onNext(e)})}s=t.utils.bind(r,function(n){e.prop("checked",n)});return new Rx.CompositeDisposable(i,s)};t.binders.click=function(e,n,r){return t.binders.event(e,n,r,"click")};t.binders.css=function(e,n,r){var i,o,s,u,a;o=new Rx.CompositeDisposable;for(s=u=0,a=r.length;u<a;s=++u){i=r[s];o.add(t.utils.bind(s,function(n){e.css(i,n)}))}return o};t.binders.event=function(e,n,t,r){var i;if(r==null){r=t.type}i=$(e).onAsObservable(r);if(typeof t==="function"){return i.subscribe(function(r){t({target:e,context:n,e:r})})}return i.subscribe(function(r){t.onNext({target:e,context:n,e:r})})};t.binders.foreach=function(e,r,i){var o,s;s=e.html().trim();e.empty();o=new Rx.CompositeDisposable({dispose:function(){return e.empty().append(s)}});setTimeout(function(){o.add(i.subscribe(function(i){var u,a,c,l,f;a=$(s).appendTo(e);o.add(u=t.internal.bind(a,{vm:i.value,vmRoot:r.vmRoot,vmParent:r.vm}));c=function(){a.remove();o.remove(u);o.remove(f);o.remove(l)};o.add(l={dispose:c});o.add(f=i.subscribe(n,c,c))}))});return o};t.binders.html=function(e,n,r){return t.utils.bind(r,function(n){e.html(n)})};t.binders.text=function(e,n,r){return t.utils.bind(r,function(n){e.text(n)})};t.binders.value=function(e,n,r){var i,o,s,u,a;if(r.onNext){u=r;s=e.onAsObservable("change").select(function(){return e.val()}).subscribe(function(e){u.onNext(e)})}if(r.subscribe){o=e.onAsObservable("focus");i=e.onAsObservable("blur");r=r.takeUntil(o).concat(i.take(1)).repeat()}a=t.utils.bind(r,function(n){e.val(n)});return new Rx.CompositeDisposable(s,a)};t.binders.value=function(e,n,r){var i,o,s,u,a,c;r=t.utils.parseBindingOptions(r);if(r.on&&r.on.indexOf("after")===0){r.on=r.on.slice(5);r.delay=true}if(typeof r.source.onNext==="function"){a=r.source;u=e.onAsObservable(r.on||"change");if(r.delay){u=u.delay(0)}s=u.select(function(){return e.val()}).doAction(function(e){return console.log(e)}).subscribe(function(e){a.onNext(e)})}if(r.source instanceof Rx.Observable){o=e.onAsObservable("focus");i=e.onAsObservable("blur");r.source=r.source.takeUntil(o).concat(i.take(1)).repeat()}c=t.utils.bind(r.source,function(n){e.val(n)});return new Rx.CompositeDisposable(s,c)};t.binders.visible=function(e,n,r){return t.utils.bind(obsOrValue,function(n){e.css(n?"":"none")})}}).call(this);