(function(){var t,e,n,r={}.hasOwnProperty,i=function(t,e){for(var n in e){if(r.call(e,n))t[n]=e[n]}function i(){this.constructor=t}i.prototype=e.prototype;t.prototype=new i;t.__super__=e.prototype;return t};n=window.sx={utils:{},internal:{},binders:{}};e=function(){};t={dispose:e};n.utils.bind=function(t,e){if(t.subscribe){return t.subscribe(e)}return e(t)};n.utils.combineLatest=function(){var t,e;t=Array.prototype.slice.call(arguments);t.push(function(){return arguments});e=t.shift();return Rx.Observable.prototype.combineLatest.apply(e,t)};n.utils.wrap=function(t){if(t.value&&t.subscribe){return t}return new Rx.BehaviorSubject(t)};n.utils.unwrap=function(t){if(t.value&&t.subscribe){return t.value}return t};n.bind=function(t,e){e=$(e||window.document.body);return n.internal.bind(e,{vm:t,vmRoot:t,vmParent:void 0})};n.computed=function(t){var e,r,i,s,o,u;r=[];o=[];u=t.params;for(e in u){s=u[e];r.push(e);o.push(n.utils.wrap(s))}i=n.utils.combineLatest(o).select(function(t){var n,i,s,o;i={};for(n=s=0,o=r.length;s<o;n=++s){e=r[n];i[e]=t[n]}return i});return Rx.Observable.create(function(e){return i.select(t.read).subscribe(e)})};n.utils.combineLatest(values).select(function(t){});n.internal.bind=function(t,e){var r,i,s,o;i=n.internal.parseBindings(t,e);s=new Rx.CompositeDisposable;for(r in i){o=i[r];s.add(n.binders[r](t,e,o))}t.children().each(function(){return s.add(n.internal.bind($(this),e))});return s};n.internal.parseBindings=function(t,e){var n,r,i,s,o,u;n=t.attr("data-splash");if(!n){return null}i=["$data","$root","$parent"];o=[e.vm,e.vmRoot,e.vmParent];u=e.vm;for(r in u){s=u[r];i.push(r);o.push(s)}return new Function(i,"return { "+n+" };").apply(null,o)};n.ObservableArray=function(t){i(e,t);function e(t){var n,r,i;if(t==null){t=[]}e.__super__.constructor.apply(this,arguments);this.values=[];this.lifetimes=[];for(r=0,i=t.length;r<i;r++){n=t[r];this.push(n)}}e.prototype.push=function(t){var e;this.values.push(t);this.lifetimes.push(e=new Rx.BehaviorSubject(t));this.onNext(e);return t};e.prototype.remove=function(t){var e;e=this.values.indexOf(t);if(e===-1){console.log(e)}return this.splice(e,1)};e.prototype.splice=function(){var t,e,n,r,i;Array.prototype.splice.apply(this.values,arguments);e=Array.prototype.splice.apply(this.lifetimes,arguments);i=[];for(n=0,r=e.length;n<r;n++){t=e[n];i.push(t.onCompleted())}return i};e.prototype.subscribe=function(t){var n,r,i,s,o;r=e.__super__.subscribe.apply(this,arguments);this.purge();t=arguments.length>1||typeof t==="function"?t:t.onNext;o=this.lifetimes;for(i=0,s=o.length;i<s;i++){n=o[i];t(n)}return r};e.prototype.purge=function(){var t,e,n,r,i;r=this.lifetimes;i=[];for(e=0,n=r.length;e<n;e++){t=r[e];if(t.isCompleted){i.push(this.remove(t))}}return i};e.prototype.dispose=function(){var t,e,n,r,i;r=this.lifetimes;i=[];for(e=0,n=r.length;e<n;e++){t=r[e];i.push(t.onCompleted())}return i};return e}(Rx.Subject);n.binders.click=function(t,e,r){return n.binders.event(t,e,r,"click")};n.binders.css=function(t,e,r){var i,s,o,u,a;s=new Rx.CompositeDisposable;for(o=u=0,a=r.length;u<a;o=++u){i=r[o];s.add(n.utils.bind(o,function(e){t.css(i,e)}))}return s};n.binders.event=function(t,e,n,r){var i;if(r==null){r=n.type}i=$(t).onAsObservable(r);if(typeof n==="function"){return i.subscribe(function(r){n({target:t,context:e,e:r})})}return i.subscribe(function(r){n.onNext({target:t,context:e,e:r})})};n.binders.foreach=function(t,r,i){var s,o;o=t.html().trim();t.empty();s=new Rx.CompositeDisposable({dispose:function(){return t.empty().append(o)}});setTimeout(function(){s.add(i.subscribe(function(i){var u,a,c,l,p;a=$(o).appendTo(t);s.add(u=n.internal.bind(a,{vm:i.value,vmRoot:r.vmRoot,vmParent:r.vm}));c=function(){a.remove();s.remove(u);s.remove(p);s.remove(l)};s.add(l={dispose:c});s.add(p=i.subscribe(e,c,c))}))});return s};n.binders.html=function(t,e,r){return n.utils.bind(r,function(e){t.html(e)})};n.binders.text=function(t,e,r){return n.utils.bind(r,function(e){t.text(e)})};n.binders.value=function(t,e,r){var i,s,o,u,a;if(r.onNext){u=r;o=t.onAsObservable("change").subscribe(function(e){u.onNext(t.val())})}if(r.subscribe){s=t.onAsObservable("focus");i=t.onAsObservable("blur");r=r.takeUntil(i).concat(i.take(1)).repeat()}a=n.utils.bind(r,function(e){t.val(e)});return new Rx.CompositeDisposable(o,a)}}).call(this);